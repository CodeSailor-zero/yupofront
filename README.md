# 伙伴匹配
> 作者 sean <br>
> [GitHub主页](https://github.com/CodeSailor-zero)

# 项目介绍
伙伴匹配系统是一个移动端网页的在线云交友平台。实现了按标签匹配、查找用户，
同时个人还可以建队、组队以打造个人学习队伍。除了添加好友、搜索好友外，
还基于 Websocket 实现好友间私聊，方便用户寻找志同道合的学习搭子。
## 前端地址
[伙伴匹配前端](https://github.com/CodeSailor-zero/yupofront)
## 后端地址
[伙伴匹配后端](https://github.com/CodeSailor-zero/yupoBackend)

# 技术选型
## 前端
| 技术      | 用途 | 版本 |
| ----------- | ----------- |-----------|
| Vue         |前端经典框架  |3.4.21     |
| Vue Route   | 细致的导航控制|4.3.2     |
| Axios       | 发送请求到后端 |1.7.2    |
| Vant        | 移动端样式组件库|4.9.0   |
| Vite        | 前端构建工具 |5.2.0      |

## 后端
| 技术      | 用途 | 版本 |
| ----------- | ----------- |-----------|
| Spring Boot |快构建 Spring 应用  |2.6.13|
| JDK         | Java 应用开发工具  |1.8   |
| MyBatis     | 操作数据库的框架   |2.2.2 |
| MyBatis-plus| MyBatis的增强框架，无需编写 SQL 语句|3.5.1|
| MYSQL       | 一个关系型数据库产品，用于存储数据 |     |
| Redis       | 一个非关系型数据库产品，用于存储数据 |2.6.13 |
| Redisson    | 分布式锁 |3.18.0 |
| WebStock    | 使得客户端和服务器之间的数据交换变得更加简单 |     |
| Lombok      | 实体类方法的快速生成工具 |     |
| knife4j     | 在线接口文档生成的库 |2.0.7      |
| EasyExcel   | 快速、低占用地操作 Excel |5.2.0      |
| hutool      | 强而全的工具库  |5.8.8 |
| Apache-commons-lang3 | 工具库 |3.12.0 |
| aliyunOss | 上传头像图片 |3.17.2 |

# 个人介绍
一个普通学校的大四学生，即将大四毕业了，正在找工作。
> 觉得项目还不错的同学可否给我项目点个 Star 呢？如果可以，小弟不胜感激，谢谢！

# 功能展示
![项目登录页](https://github-program-show.oss-cn-shanghai.aliyuncs.com/%E4%BC%99%E4%BC%B4%E5%8C%B9%E9%85%8D%E7%99%BB%E5%BD%95%E9%A1%B5%E9%9D%A2.png?Expires=1746901040&OSSAccessKeyId=TMP.3KmXkvBdrGhzdKwnKmU49WzUeSVPSGKekh1ePTDGzxencJvUkrg1WkjRXCw7g9mX4Xivzm1o2ive4AXgFRUYJvkFbgnxcK&Signature=Il6Fim8PqOKR4F32JCZhaCmYFCQ%3D "Magic Gardens")<br>
![项目主页](https://github-program-show.oss-cn-shanghai.aliyuncs.com/%E4%BC%99%E4%BC%B4%E5%8C%B9%E9%85%8D%E4%B8%BB%E9%A1%B5.png?Expires=1746900979&OSSAccessKeyId=TMP.3KmXkvBdrGhzdKwnKmU49WzUeSVPSGKekh1ePTDGzxencJvUkrg1WkjRXCw7g9mX4Xivzm1o2ive4AXgFRUYJvkFbgnxcK&Signature=b1J1vskZMGhxWFEyGokbkDpUkgM%3D "Magic Gardens")<br>
![项目博客页](https://github-program-show.oss-cn-shanghai.aliyuncs.com/%E4%BC%99%E4%BC%B4%E5%8C%B9%E9%85%8D%E5%8D%9A%E5%AE%A2%E9%A1%B5%E9%9D%A2.png?Expires=1746901012&OSSAccessKeyId=TMP.3KmXkvBdrGhzdKwnKmU49WzUeSVPSGKekh1ePTDGzxencJvUkrg1WkjRXCw7g9mX4Xivzm1o2ive4AXgFRUYJvkFbgnxcK&Signature=i8saxaZzMu6HhantBQXpZIiuWe4%3D "Magic Gardens")<br>
![项目群聊页](https://github-program-show.oss-cn-shanghai.aliyuncs.com/%E4%BC%99%E4%BC%B4%E5%8C%B9%E9%85%8D%E7%BE%A4%E8%81%8A%E9%A1%B5%E9%9D%A2.png?Expires=1746901068&OSSAccessKeyId=TMP.3KmXkvBdrGhzdKwnKmU49WzUeSVPSGKekh1ePTDGzxencJvUkrg1WkjRXCw7g9mX4Xivzm1o2ive4AXgFRUYJvkFbgnxcK&Signature=sHSFYfJ1J%2FSrt5bxGAPdqdJzH2Q%3D "Magic Gardens")<br>
![个人聊天页](https://github-program-show.oss-cn-shanghai.aliyuncs.com/%E4%BC%99%E4%BC%B4%E5%8C%B9%E9%85%8D%E8%81%8A%E5%A4%A9%E9%A1%B5%E9%9D%A2.png?Expires=1746901100&OSSAccessKeyId=TMP.3KmXkvBdrGhzdKwnKmU49WzUeSVPSGKekh1ePTDGzxencJvUkrg1WkjRXCw7g9mX4Xivzm1o2ive4AXgFRUYJvkFbgnxcK&Signature=gwSJAQQtl55JTZx85oinHxacucU%3D "Magic Gardens")<br>

# 项目亮点
- 基于 Redis 实现分布式 Session 存储
- 基于 Redis 分布式锁防止用户重复入队
- Spring Scheduling + Redis 分布式锁实现缓存预热
- 了解编辑距离算法，可用于匹配相似字符串，单词校验
- 基于 Websocket 实现用户间私聊
- 基于aliyunOss上传头像图片
- 集成第三方库生成接口测试文档，方便测试项目接口
- 熟悉 EasyExcel 的使用
- 基于 Axios 封装请求实例，方便请求后端接口
- 熟悉 Vant 组件库的使用
- 熟悉 Vue3 setup 语法
- 掌握 Vue-Router 基本使用，vue-router实现拦截器，拦截用户未登录

# 数据库表
> 如果大家拉取了后端源码，直接找到 sql/create_sql.sql 文件直接运行即可创建相应数据库和表结构
## 用户表
```sql
create table user
(
    username     varchar(256)                       null comment '用户呢称',
    id           bigint auto_increment comment 'id'
        primary key,
    userAccount  varchar(256)                       null comment '账号',
    avatarUrl    varchar(1024)                      null comment '用户头像',
    gender       tinyint                            null comment '性别 0 - > 女 1 - >男',
    profile      varchar(512)                       null comment '个人介绍',
    userPassword varchar(512)                       not null comment '密码',
    phone        varchar(128)                       null comment '电话',
    email        varchar(512)                       null comment '邮箱',
    userStatus   int      default 0                 not null comment '状态0 - 正常',
    userIds      varchar(512)                       null comment '好友id列表',
    createTime   datetime default CURRENT_TIMESTAMP not null comment '创建时间',
    updateTime   datetime default CURRENT_TIMESTAMP null on update CURRENT_TIMESTAMP,
    isDelete     tinyint  default 0                 not null comment '是否删除',
    userRole     int      default 0                 not null comment '用户角色 0 - 普通用户 1 - 管理员',
    planetCode   varchar(512)                       null comment '星球编号',
    tags         varchar(1024)                      null comment '标签列表 json'
)
    comment '用户';
```
## 队伍表
```sql
create table team
(
    id          bigint auto_increment comment 'id'
        primary key,
    name        varchar(256)                       not null comment '队伍名称',
    description varchar(1024)                      null comment '描述',
    maxNum      int      default 1                 not null comment '最大人数',
    expireTime  datetime                           null comment '过期时间',
    userId      bigint                             null comment '用户id',
    status      int      default 0                 not null comment '0 - 公开，1 - 私有，2 - 加密',
    password    varchar(512)                       null comment '密码',
    createTime  datetime default CURRENT_TIMESTAMP null comment '创建时间',
    updateTime  datetime default CURRENT_TIMESTAMP null on update CURRENT_TIMESTAMP,
    isDelete    tinyint  default 0                 not null comment '是否删除'
) comment '队伍';
```
## 用户队伍关系
```sql
create table user_team
(
    id         bigint auto_increment comment 'id' primary key,
    userId     bigint comment '用户id',
    teamId     bigint comment '队伍id',
    joinTime   datetime                           null comment '加入时间',
    createTime datetime default CURRENT_TIMESTAMP null comment '创建时间',
    updateTime datetime default CURRENT_TIMESTAMP null on update CURRENT_TIMESTAMP,
    isDelete   tinyint  default 0                 not null comment '是否删除'
) comment '用户队伍关系';
```
## 好友表
```sql
-- auto-generated definition
create table friends
(
    id         bigint auto_increment comment 'id主键'
        primary key,
    userId     bigint                             not null comment '发送好友申请的id',
    friendId   bigint                             not null comment '接受好友信息的id',
    remark     varchar(200)                       null comment '申请好友的描述',
    status     tinyint  default 0                 not null comment '0-未通过 1-已同意 2-已过期 3-已撤销',
    createTime datetime default CURRENT_TIMESTAMP null comment '创建时间',
    updateTime datetime default CURRENT_TIMESTAMP null on update CURRENT_TIMESTAMP,
    isDelete   tinyint  default 0                 not null comment '是否删除'
)
    comment '好友申请关系表';
```
## 聊天表
```sql
create table chat
(
    id         bigint auto_increment comment '聊天记录id'
        primary key,
    fromId     bigint                                  not null comment '发送消息id',
    toId       bigint                                  null comment '接收消息id',
    teamId     bigint                                  null comment '群聊id',
    text       varchar(512) collate utf8mb4_unicode_ci null comment '消息内容',
    chatType   tinyint                                 not null comment '聊天类型 1-私聊 2-群聊/team聊天',
    createTime datetime default CURRENT_TIMESTAMP      null comment '创建时间',
    updateTime datetime default CURRENT_TIMESTAMP      null comment '更新时间',
    isDelete   tinyint  default 0                      not null comment '是否删除'
)
    comment '聊天消息表';
```
## 博客表
```sql
create table blog
(
    blogId       tinyint auto_increment comment '博客文章Id'
        primary key,
    createUserId tinyint                            not null comment '创建人Id',
    tittle       varchar(50)                        not null comment '标题',
    text         varchar(1024)                      not null comment '正文',
    topicTags    varchar(512)                       null comment '话题标签 | json字符串',
    remarkNum    tinyint  default 0                 null comment '评论数量',
    startIds     varchar(125)                       null comment '点赞博客用户Id',
    createTime   datetime default CURRENT_TIMESTAMP null comment '创建时间',
    updateTime   datetime default CURRENT_TIMESTAMP null on update CURRENT_TIMESTAMP comment '更新时间',
    isDelete     tinyint  default 0                 null comment '逻辑删除 0 - 不删除，1 - 删除'
)
    comment '博客表';
```
## 用户博客关系表
```sql
create table user_blog
(
    userId     tinyint                            not null comment '对 blog 做出操作的用户 Id',
    blogId     tinyint                            not null comment '博客id',
    remark     varchar(512)                       null comment '评论',
    remarkNum  varchar(512)                       null comment '评论点赞用户id',
    createTime datetime default CURRENT_TIMESTAMP null comment '创建时间',
    updateTime datetime default CURRENT_TIMESTAMP null comment '更新时间',
    isDelete   tinyint  default 0                 null comment '逻辑删除 0 - 不删除，1 - 删除'
)
    comment '用户博客关系表';
```

# 项目初始化
## 前端
基础环境 
- 软件：WebStorm 2022.3.4
- 环境：18.20.3 <br>
1. 拉取项目
```shell
git clone https://github.com/CodeSailor-zero/yupofront.git
```
2. 安装依赖
```shell
npm install
```
4. 运行项目
```shell
npm run dev
```
6. 打包项目
```shell
npm run build
```

## 后端
基础环境
- 软件：IDEA 2023.1.6
- JDK 1.8 + MySQL 5.7.19 + Redis 5.x（最好是 5.x 以上） + Spring Boot 2.6.13
> 更细的环境请看上面的技术选型，上面有具体的依赖关系和版本。
>各位一定要注意在启动后端前，一定要先建好数据库表和安装 Redis，改好 yml 文件的连接信息再启动后端。
1. 拉取项目
```shell
git clone https://github.com/CodeSailor-zero/yupoBackend.git
```
3. 加载Maven
4. 启动后端
> 找到 UserCenterApplication.java 启动类，启动后端

### 后端注意点
> 记得切换自己的 ip + port <br>
> 记得配置自己的mysql账号和密码，还有redis的账号和密码
```yaml
  #数据库mysql的配置
  datasource:
    driver-class-name: com.mysql.cj.jdbc.Driver
    url: jdbc:mysql://localhost:3306/yup?serverTimezone=GMT
    username: sean
    password: 123456
 # redis的配置
  redis:
    port: 6379
    host: localhost
    database: 0
    password: 123456
```
